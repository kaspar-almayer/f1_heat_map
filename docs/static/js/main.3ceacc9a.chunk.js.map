{"version":3,"sources":["helpers.ts","supabaseClient.js","Column.tsx","RaceSelect.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["getSeconds","lapTime","splitSeconds","split","splitMiliseconds","sec","Number","formatTime","timeInSeconds","minutes","Math","floor","seconds","String","toFixed","padStart","getHsl","value","range","colors","hue","getMedian","laps","sort","a","b","length","middle","round","flatLapTimes","race","data","reduce","result","currentValue","timings","push","flat","supabase","createClient","Column","driver","fontSize","className","map","lap","index","style","backgroundColor","RaceSelect","setRace","useState","racesList","setRacesList","useEffect","getData","from","select","order","ascending","error","console","log","htmlFor","name","id","onChange","event","eq","currentTarget","races","short_name","App","setRange","loading","setLoading","setError","setColors","cutout","setCutout","setFontSize","timsesInSeconds","median","timesWthoutPitstops","filter","time","min","max","getRange","excludedTimes","useMemo","calculateCutout","race_name","type","el","href","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3ceacc9a.chunk.js","sourcesContent":["import { Race } from \"./types\";\n\nexport const getSeconds = (lapTime: String): number => {\n  const splitSeconds = lapTime.split(\":\");\n  const splitMiliseconds = splitSeconds[1].split(\".\");\n\n  const sec = Number(splitSeconds[0]) * 60 + Number(splitMiliseconds[0]);\n  return Number(`${sec}.${splitMiliseconds[1]}`);\n};\n\nexport const formatTime = (timeInSeconds: number): string => {\n  const minutes = Math.floor(timeInSeconds / 60);\n  const seconds = String((timeInSeconds % 60).toFixed(3)).padStart(6, \"0\");\n  return `${minutes}:${seconds}`;\n};\n\nexport const getHsl = (value: number, range: number[], colors: string) => {\n  if (value < range[0] || value > range[1]) {\n    return `hsl(0, 0%, 50%)`;\n  }\n  const hue = ((value - range[0]) * Number(colors)) / (range[1] - range[0]);\n  return `hsl(${hue}, 100%, 50%)`;\n};\n\nexport const getMean = (laps: Array<number>) => {\n  return laps.reduce((a, b) => a + b, 0) / laps.length;\n};\n\nexport const getMedian = (laps: Array<number>): number => {\n  laps.sort((a, b) => a - b);\n  if (laps.length % 2 === 0) {\n    const middle = laps.length / 2;\n    return (laps[middle - 1] + laps[middle]) / 2;\n  } else {\n    return laps[Math.round(laps.length / 2)];\n  }\n};\n\nexport const getRange = (laps: Array<string>, cutout: number): number[] => {\n  const timsesInSeconds = laps.map((lapTime) => getSeconds(lapTime));\n\n  const median = Math.round(getMedian(timsesInSeconds));\n\n  const timesWthoutPitstops = timsesInSeconds.filter(\n    (time) => time < median + cutout\n  );\n\n  return [Math.min(...timesWthoutPitstops), Math.max(...timesWthoutPitstops)];\n};\n\nexport const flatLapTimes = (race: Race): string[] => {\n  return race.data\n    .reduce((result, currentValue) => {\n      if (currentValue.timings) {\n        result.push(currentValue.timings as string[]);\n      }\n      return result;\n    }, [] as string[][])\n    .flat();\n  //return race.data.map((el) => el.timings).flat()\n};\n","import { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = \"https://rkpsepkibztbweplxsli.supabase.co\"\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJrcHNlcGtpYnp0YndlcGx4c2xpIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTc0NzE4MDAsImV4cCI6MTk3MzA0NzgwMH0.-TsomBTEZlmHZ6cS3qqbF7f1G8OLsNSgMkquuPrt1PA\"\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)","import React from \"react\";\nimport \"./App.css\";\nimport { getHsl, getSeconds } from \"./helpers\";\n\ntype ColumnProps = {\n  laps: string[];\n  range: Array<number>;\n  driver: string;\n  colors: string;\n  fontSize: string;\n};\n\nconst Column = ({ laps, range, driver, colors, fontSize }: ColumnProps) => {\n  return (\n    <div className=\"column\">\n      <p className=\"driver-name\">{driver}</p>\n      {laps.map((lap, index) => (\n        <p\n          key={index}\n          style={{\n            backgroundColor: getHsl(getSeconds(lap), range, colors),\n            fontSize: `${fontSize}px`,\n          }}\n        >\n          {lap}\n        </p>\n      ))}\n    </div>\n  );\n};\n\nexport default Column;\n","import React, { useState, useEffect } from \"react\";\n\nimport { supabase } from \"./supabaseClient\";\nimport { Race, RacesList } from \"./types\";\n\ntype RaceSelectProps = {\n  race: Race | null;\n  setRace: Function;\n};\n\nfunction RaceSelect({ race, setRace }: RaceSelectProps) {\n  const [racesList, setRacesList] = useState<RacesList>([]);\n\n  useEffect(() => {\n    const getData = async () => {\n      try {\n        let { data, error } = await supabase\n          .from(\"races\")\n          .select(\"id,short_name\")\n          .order(\"round\", { ascending: false });\n\n        if (data) {\n          setRacesList(data);\n        }\n\n        if (error) {\n          throw error;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    getData();\n  }, []);\n\n  const handleRaceChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const getData = async () => {\n      try {\n        let { data: races, error } = await supabase\n          .from(\"races\")\n          .select(\"*\")\n          .eq(\"id\", event?.currentTarget?.value);\n\n        if (races) {\n          setRace(races[0] as Race);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    getData();\n  };\n\n  return (\n    <>\n      {racesList.length ? (\n        <div className=\"race-input\">\n          <label htmlFor=\"races\">select race:</label>\n          <select\n            name=\"races\"\n            id=\"races\"\n            value={race?.id}\n            onChange={handleRaceChange}\n          >\n            {racesList.map((race) => (\n              <option key={race.id} value={race.id}>\n                {race.short_name}\n              </option>\n            ))}\n          </select>\n        </div>\n      ) : null}\n    </>\n  );\n}\n\nexport default RaceSelect;\n","import React, { useState, useMemo, useEffect } from \"react\";\n\nimport \"./App.css\";\nimport {\n  getRange,\n  getMedian,\n  getSeconds,\n  formatTime,\n  flatLapTimes,\n} from \"./helpers\";\nimport { supabase } from \"./supabaseClient\";\nimport { Race } from \"./types\";\n\nimport Column from \"./Column\";\nimport RaceSelect from \"./RaceSelect\";\n\nconst calculateCutout = (laps: Array<string>, cutout: number) => {\n  const timsesInSeconds = laps.map((lapTime) => getSeconds(lapTime));\n\n  const median = Math.round(getMedian(timsesInSeconds));\n  return median + cutout;\n};\n\nfunction App() {\n  const [race, setRace] = useState<Race | null>(null);\n  const [range, setRange] = useState<number[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n\n  const [colors, setColors] = useState(\"150\");\n  const [cutout, setCutout] = useState(\"7\");\n  const [fontSize, setFontSize] = useState(\"14\");\n\n  useEffect(() => {\n    const getData = async () => {\n      try {\n        let { data: races, error } = await supabase\n          .from(\"races\")\n          .select(\"*\")\n          .eq(\"round\", \"12\");\n\n        if (races) {\n          setRace(races[0] as Race);\n          setLoading(false);\n        }\n\n        if (error) {\n          throw error;\n        }\n      } catch (error) {\n        setLoading(false);\n        setError(true);\n      }\n    };\n\n    getData();\n  }, []);\n\n  useEffect(() => {\n    if (race) {\n      setRange(getRange(flatLapTimes(race), Number(cutout)));\n    }\n  }, [race, cutout]);\n\n  const excludedTimes = useMemo(\n    () => (race ? calculateCutout(flatLapTimes(race), Number(cutout)) : 0),\n    [race, cutout]\n  );\n\n  const handleColorChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setColors(event?.currentTarget?.value);\n  };\n\n  const handleCutoutChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setCutout(event?.currentTarget?.value);\n  };\n\n  const handleSizeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setFontSize(event?.currentTarget?.value);\n  };\n\n  return (\n    <div className=\"app-wrapper\">\n      <header className=\"main-header\">\n        <h1>Lap times heat map | {race?.race_name}</h1>\n        <RaceSelect race={race} setRace={setRace} />\n      </header>\n      <main>\n        <div className=\"settings-wrapper\">\n          <div className=\"settings-input\">\n            <label>adjust colors:</label>\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"300\"\n              value={colors}\n              onChange={handleColorChange}\n            ></input>\n          </div>\n          <div className=\"settings-input\">\n            <label>\n              exclued times over: <br />\n              <b>{formatTime(excludedTimes)}</b>\n            </label>\n            <input\n              type=\"range\"\n              min=\"1\"\n              max=\"30\"\n              value={cutout}\n              onChange={handleCutoutChange}\n            ></input>\n          </div>\n\n          <div className=\"settings-input\">\n            <label>heat map size: {fontSize}</label>\n            <input\n              type=\"range\"\n              min=\"7\"\n              max=\"20\"\n              value={fontSize}\n              onChange={handleSizeChange}\n            ></input>\n          </div>\n        </div>\n        {loading ? <p>loading...</p> : null}\n        {error ? (\n          <p>There was a problem with data, please try again later.</p>\n        ) : null}\n\n        {race ? (\n          <div className=\"columns-wrapper\">\n            {race.data.map(\n              (el, index) =>\n                el.timings && (\n                  <Column\n                    key={index}\n                    laps={el.timings}\n                    range={range}\n                    driver={el.driver}\n                    colors={colors}\n                    fontSize={fontSize}\n                  />\n                )\n            )}\n          </div>\n        ) : null}\n      </main>\n      <footer>\n        <p>\n          lap times data:{\" \"}\n          <a href=\"http://ergast.com/mrd/\">http://ergast.com/mrd/</a>\n        </p>\n        <p>\n          inspiration:{\" \"}\n          <a href=\"https://www.reddit.com/r/formula1/comments/tps40h/2022_saudi_arabian_grand_prix_lap_time_heat_map/\">\n            https://www.reddit.com/r/formula1/comments/tps40h/2022_saudi_arabian_grand_prix_lap_time_heat_map/\n          </a>\n        </p>\n      </footer>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}